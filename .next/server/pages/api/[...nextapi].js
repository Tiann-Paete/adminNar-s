"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/[...nextapi]";
exports.ids = ["pages/api/[...nextapi]"];
exports.modules = {

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mysql2/promise":
/*!*********************************!*\
  !*** external "mysql2/promise" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("mysql2/promise");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\[...nextapi].js */ \"(api)/./src/pages/api/[...nextapi].js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/[...nextapi]\",\n        pathname: \"/api/[...nextapi]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRiU1Qi4uLm5leHRhcGklNUQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlNUNwYWdlcyU1Q2FwaSU1QyU1Qi4uLm5leHRhcGklNUQuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDK0Q7QUFDL0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHNEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxzREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbnBhbmVsLz82YWUxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmNcXFxccGFnZXNcXFxcYXBpXFxcXFsuLi5uZXh0YXBpXS5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL1suLi5uZXh0YXBpXVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL1suLi5uZXh0YXBpXVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/[...nextapi].js":
/*!***************************************!*\
  !*** ./src/pages/api/[...nextapi].js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler),\n/* harmony export */   handleUpdateAdminData: () => (/* binding */ handleUpdateAdminData)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! url */ \"url\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/db */ \"(api)/./src/utils/db.js\");\n\n\n\n\nconst db = mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createPool({\n    host: process.env.MYSQL_HOST,\n    port: process.env.MYSQL_PORT,\n    user: process.env.MYSQL_USER,\n    password: process.env.MYSQL_PASSWORD,\n    database: process.env.MYSQL_DATABASE,\n    waitForConnections: true,\n    connectionLimit: 10,\n    queueLimit: 0\n});\nasync function handler(req, res) {\n    const { method } = req;\n    const { pathname, query } = (0,url__WEBPACK_IMPORTED_MODULE_1__.parse)(req.url, true);\n    console.log(\"Received request:\", method, pathname, query);\n    if (pathname === \"/api/test\") {\n        res.status(200).json({\n            message: \"Test route working\"\n        });\n        return;\n    }\n    if (pathname === \"/api/admin-name\") {\n        try {\n            const [results] = await db.query(\"SELECT full_name FROM admin LIMIT 1\");\n            if (results.length > 0) {\n                res.status(200).json({\n                    fullName: results[0].full_name\n                });\n            } else {\n                res.status(404).json({\n                    error: \"Admin not found\"\n                });\n            }\n        } catch (error) {\n            console.error(\"Error fetching admin name:\", error);\n            res.status(500).json({\n                error: \"An error occurred while fetching admin name\"\n            });\n        }\n        return;\n    }\n    try {\n        switch(method){\n            case \"GET\":\n                if (pathname === \"/api/check-auth\") {\n                    const authHeader = req.headers.authorization;\n                    if (!authHeader) {\n                        return res.status(200).json({\n                            isAuthenticated: false,\n                            usernamePasswordVerified: false\n                        });\n                    }\n                    const token = authHeader.split(\" \")[1];\n                    try {\n                        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n                        const now = Math.floor(Date.now() / 1000);\n                        if (decoded.exp && decoded.exp > now) {\n                            // Token is still valid\n                            return res.status(200).json({\n                                isAuthenticated: true,\n                                usernamePasswordVerified: true,\n                                expiresIn: decoded.exp - now\n                            });\n                        } else {\n                            // Token has expired\n                            return res.status(200).json({\n                                isAuthenticated: false,\n                                usernamePasswordVerified: false\n                            });\n                        }\n                    } catch (error) {\n                        return res.status(200).json({\n                            isAuthenticated: false,\n                            usernamePasswordVerified: false\n                        });\n                    }\n                } else if (pathname === \"/api/products\") {\n                    await handleGetProducts(req, res);\n                } else if (pathname === \"/api/total-stock\") {\n                    await handleGetTotalStock(req, res);\n                } else if (pathname === \"/api/sales-report\") {\n                    await handleGetSalesReport(req, res);\n                } else if (pathname === \"/api/sales-data\") {\n                    await handleGetSalesData(req, res);\n                } else if (pathname === \"/api/total-products\") {\n                    await handleGetTotalProducts(req, res);\n                } else if (pathname === \"/api/top-products\") {\n                    await handleGetTopProducts(req, res);\n                } else if (pathname === \"/api/rated-products-count\") {\n                    await handleGetRatedProductsCount(req, res);\n                } else if (pathname === \"/api/logout\") {\n                    handleLogout(req, res);\n                } else if (pathname === \"/api/orders\") {\n                    await handleGetOrders(req, res);\n                } else if (pathname === \"/api/admin-data\") {\n                    await handleGetAdminData(req, res);\n                }\n                break;\n            case \"POST\":\n                if (pathname === \"/api/signin\") {\n                    await handleSignIn(req, res);\n                } else if (pathname === \"/api/validate-pin\") {\n                    await handleValidatePin(req, res);\n                } else if (pathname === \"/api/products\") {\n                    await handleAddProduct(req, res);\n                }\n                break;\n            case \"PUT\":\n                if (pathname.startsWith(\"/api/products/\")) {\n                    const id = pathname.split(\"/\").pop();\n                    await handleUpdateProduct(req, res, id);\n                } else if (pathname.startsWith(\"/api/orders/\")) {\n                    const parts = pathname.split(\"/\");\n                    const id = parts[3]; // This is the order ID\n                    if (parts[4] === \"status\") {\n                        await handleUpdateOrderStatus(req, res, id);\n                    } else if (parts[4] === \"cancel\") {\n                        await handleCancelOrder(req, res, id);\n                    } else {\n                        await handleUpdateOrder(req, res, id);\n                    }\n                }\n                if (pathname === \"/api/update-admin\") {\n                    await handleUpdateAdminData(req, res);\n                }\n                break;\n            case \"DELETE\":\n                if (pathname.startsWith(\"/api/products/\")) {\n                    const id = pathname.split(\"/\").pop();\n                    await handleDeleteProduct(req, res, id);\n                } else if (pathname.startsWith(\"/api/orders/\") && pathname.endsWith(\"/salesreport\")) {\n                    await handleRemoveOrderFromSalesReport(req, res);\n                } else {\n                    res.status(404).json({\n                        error: \"Route not found\"\n                    });\n                }\n                break;\n            default:\n                res.setHeader(\"Allow\", [\n                    \"GET\",\n                    \"POST\",\n                    \"PUT\",\n                    \"DELETE\"\n                ]);\n                res.status(405).end(`Method ${method} Not Allowed`);\n        }\n        res.status(404).json({\n            error: \"Route not found\"\n        });\n    } catch (error) {\n        console.error(\"Error in API route:\", error);\n        res.status(500).json({\n            error: \"An error occurred while processing your request\"\n        });\n    }\n}\nasync function handleSignIn(req, res) {\n    const { username, password } = req.body;\n    console.log(\"Signin attempt:\", {\n        username\n    }); // Don't log passwords\n    try {\n        const [results] = await db.query(\"SELECT * FROM admin WHERE username = ?\", [\n            username\n        ]);\n        console.log(\"Database query results:\", results);\n        if (results.length === 0) {\n            console.log(\"User not found\");\n            return res.status(401).json({\n                error: \"Invalid username or password\"\n            });\n        }\n        const user = results[0];\n        // For now, directly compare passwords\n        const passwordMatch = password === user.password;\n        if (!passwordMatch) {\n            console.log(\"Password mismatch\");\n            return res.status(401).json({\n                error: \"Invalid username or password\"\n            });\n        }\n        const token = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.sign)({\n            userId: user.id\n        }, process.env.JWT_SECRET, {\n            expiresIn: \"6h\"\n        });\n        console.log(\"Login successful, token generated\");\n        res.status(200).json({\n            success: true,\n            message: \"Signin successful\",\n            username: user.username,\n            token: token\n        });\n    } catch (error) {\n        console.error(\"Sign in error:\", error);\n        res.status(500).json({\n            error: \"An error occurred during signin\"\n        });\n    }\n}\nasync function handleValidatePin(req, res) {\n    const { pin } = req.body;\n    const token = req.headers.authorization?.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const [results] = await db.query(\"SELECT pin FROM admin WHERE id = ?\", [\n            decoded.userId\n        ]);\n        if (results.length === 0) {\n            return res.status(404).json({\n                error: \"Admin not found\"\n            });\n        }\n        const storedPin = results[0].pin;\n        if (String(pin) === String(storedPin)) {\n            res.status(200).json({\n                message: \"PIN validated successfully\"\n            });\n        } else {\n            res.status(401).json({\n                error: \"Invalid PIN\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error validating PIN:\", error);\n        res.status(500).json({\n            error: \"An error occurred while validating PIN\"\n        });\n    }\n}\nasync function handleLogout(req, res) {\n    const token = req.headers.authorization?.split(\" \")[1];\n    if (token) {\n        try {\n            // Invalidate the token in the database or wherever you're storing active sessions\n            await db.query(\"UPDATE sessions SET is_active = FALSE WHERE token = ?\", [\n                token\n            ]);\n        } catch (error) {\n            console.error(\"Error invalidating token:\", error);\n        }\n    }\n    res.setHeader(\"Set-Cookie\", \"token=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT; HttpOnly\");\n    res.status(200).json({\n        success: true,\n        message: \"Logout successful\"\n    });\n}\nasync function handleGetAdminData(req, res) {\n    try {\n        const [results] = await db.query(\"SELECT full_name, username, password, pin, role FROM admin LIMIT 1\");\n        if (results.length > 0) {\n            const adminData = results[0];\n            // Mask the password and PIN\n            adminData.password = \"*\".repeat(adminData.password.length);\n            adminData.pin = \"*\".repeat(adminData.pin.length);\n            res.status(200).json(adminData);\n        } else {\n            res.status(404).json({\n                error: \"Admin not found\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error fetching admin data:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching admin data\"\n        });\n    }\n}\n// Update this function to hash the PIN before storing\nasync function handleUpdateAdminData(req, res) {\n    const { full_name, username, password, pin, role } = req.body;\n    try {\n        let sql = \"UPDATE admin SET full_name = ?, username = ?, role = ?\";\n        let params = [\n            full_name,\n            username,\n            role\n        ];\n        if (password) {\n            sql += \", password = ?\";\n            params.push(password);\n        }\n        if (pin) {\n            sql += \", pin = ?\";\n            params.push(pin);\n        }\n        sql += \" WHERE id = 1\"; // Assuming there's only one admin record\n        const result = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(sql, params);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Admin not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Admin data updated successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating admin data:\", error);\n        res.status(500).json({\n            error: \"An error occurred while updating admin data\"\n        });\n    }\n}\nasync function handleGetSalesData(req, res) {\n    const { timeFrame } = req.query;\n    let dateCondition, statusCondition;\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    switch(timeFrame){\n        case \"today\":\n            dateCondition = \"DATE(order_date) = CURDATE()\";\n            break;\n        case \"yesterday\":\n            dateCondition = \"DATE(order_date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\";\n            break;\n        case \"lastWeek\":\n            const lastWeekStart = new Date(today);\n            lastWeekStart.setDate(lastWeekStart.getDate() - 7);\n            const lastWeekEnd = new Date(today);\n            lastWeekEnd.setDate(lastWeekEnd.getDate() - 1);\n            dateCondition = `DATE(order_date) BETWEEN '${lastWeekStart.toISOString().split(\"T\")[0]}' AND '${lastWeekEnd.toISOString().split(\"T\")[0]}'`;\n            break;\n        case \"lastMonth\":\n            const lastMonthStart = new Date(today);\n            lastMonthStart.setMonth(lastMonthStart.getMonth() - 1);\n            const lastMonthEnd = new Date(today);\n            lastMonthEnd.setDate(lastMonthEnd.getDate() - 1);\n            dateCondition = `DATE(order_date) BETWEEN '${lastMonthStart.toISOString().split(\"T\")[0]}' AND '${lastMonthEnd.toISOString().split(\"T\")[0]}'`;\n            break;\n        default:\n            dateCondition = \"DATE(order_date) = CURDATE()\";\n    }\n    try {\n        // Total Sales (always only \"Delivered\" status)\n        const [salesResult] = await db.query(`\r\n      SELECT COALESCE(SUM(total), 0) as periodSales\r\n      FROM orders\r\n      WHERE ${dateCondition} AND status = 'Delivered'\r\n    `);\n        // Total Orders\n        let ordersStatusCondition = \"status = 'Delivered'\";\n        if (timeFrame === \"lastWeek\" || timeFrame === \"lastMonth\") {\n            ordersStatusCondition = \"status IN ('Order Placed', 'Processed', 'Shipped', 'Delivered', 'Cancelled')\";\n        }\n        const [ordersResult] = await db.query(`\r\n      SELECT COUNT(*) as totalOrders\r\n      FROM orders\r\n      WHERE ${dateCondition} AND ${ordersStatusCondition}\r\n    `);\n        // Total Customers (always all statuses)\n        const [customersResult] = await db.query(`\r\n      SELECT COUNT(DISTINCT user_id) as totalCustomers\r\n      FROM orders\r\n      WHERE ${dateCondition}\r\n    `);\n        const result = {\n            periodSales: Number(salesResult[0].periodSales),\n            totalOrders: ordersResult[0].totalOrders,\n            totalCustomers: customersResult[0].totalCustomers\n        };\n        res.status(200).json(result);\n    } catch (error) {\n        console.error(\"Error fetching sales data:\", error);\n        res.status(500).json({\n            error: \"Error fetching sales data\"\n        });\n    }\n}\nasync function handleGetTotalProducts(req, res) {\n    const [result] = await db.query(\"SELECT COUNT(*) as totalProducts FROM products\");\n    res.status(200).json(result[0]);\n}\nasync function handleGetTopProducts(req, res) {\n    const [result] = await db.query(`\r\n    SELECT \r\n      p.id,\r\n      p.name,\r\n      p.image_url,\r\n      p.rating,\r\n      COALESCE(SUM(op.quantity), 0) as sold\r\n    FROM products p\r\n    LEFT JOIN ordered_products op ON p.id = op.product_id\r\n    GROUP BY p.id\r\n    ORDER BY sold DESC, p.rating DESC\r\n    LIMIT 5\r\n  `);\n    res.status(200).json(result);\n}\nasync function handleGetRatedProductsCount(req, res) {\n    const { timeFrame } = req.query;\n    let dateCondition;\n    switch(timeFrame){\n        case \"today\":\n            dateCondition = \"DATE(created_at) = CURDATE()\";\n            break;\n        case \"yesterday\":\n            dateCondition = \"DATE(created_at) = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\";\n            break;\n        case \"lastWeek\":\n            dateCondition = \"DATE(created_at) BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 WEEK) AND CURDATE()\";\n            break;\n        case \"lastMonth\":\n            dateCondition = \"DATE(created_at) BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND CURDATE()\";\n            break;\n        default:\n            dateCondition = \"DATE(created_at) = CURDATE()\";\n    }\n    const [result] = await db.query(`\r\n    SELECT COUNT(DISTINCT product_id) as ratedProductsCount\r\n    FROM product_ratings\r\n    WHERE ${dateCondition}\r\n  `);\n    res.status(200).json(result[0]);\n}\nasync function handleGetProducts(req, res) {\n    const { page = 1, limit = 10 } = req.query;\n    const offset = (page - 1) * limit;\n    try {\n        const [countResult] = await db.query(\"SELECT COUNT(*) as total FROM products WHERE deleted = FALSE\");\n        const totalItems = countResult[0].total;\n        const totalPages = Math.ceil(totalItems / limit);\n        const [products] = await db.query(\"SELECT * FROM products WHERE deleted = FALSE LIMIT ? OFFSET ?\", [\n            parseInt(limit),\n            offset\n        ]);\n        res.status(200).json({\n            products,\n            currentPage: parseInt(page),\n            totalPages,\n            totalItems\n        });\n    } catch (error) {\n        console.error(\"Error fetching products:\", error);\n        res.status(500).json({\n            error: \"Error fetching products\"\n        });\n    }\n}\nasync function handleGetTotalStock(req, res) {\n    try {\n        const [result] = await db.query(\"SELECT SUM(stock_quantity) as totalStock FROM products\");\n        res.status(200).json({\n            totalStock: result[0].totalStock\n        });\n    } catch (error) {\n        console.error(\"Error fetching total stock:\", error);\n        res.status(500).json({\n            error: \"Error fetching total stock\"\n        });\n    }\n}\nasync function handleAddProduct(req, res) {\n    const { name, description, price, image_url, stock_quantity, category, supplier_id, rating } = req.body;\n    const order_id = generateOrderId();\n    const sql = \"INSERT INTO products (name, description, price, image_url, stock_quantity, category, supplier_id, order_id, rating) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\";\n    try {\n        const [result] = await db.query(sql, [\n            name,\n            description,\n            price,\n            image_url,\n            stock_quantity,\n            category,\n            supplier_id,\n            order_id,\n            rating\n        ]);\n        res.status(201).json({\n            message: \"Product added successfully\",\n            id: result.insertId,\n            order_id: order_id\n        });\n    } catch (error) {\n        console.error(\"Error adding product:\", error);\n        res.status(500).json({\n            error: \"Error adding product\"\n        });\n    }\n}\nfunction generateOrderId() {\n    return \"ORD-\" + Math.random().toString(36).substr(2, 9).toUpperCase();\n}\nasync function handleUpdateProduct(req, res, id) {\n    const { name, description, price, image_url, stock_quantity, category, supplier_id, rating } = req.body;\n    const sql = \"UPDATE products SET name=?, description=?, price=?, image_url=?, stock_quantity=?, category=?, supplier_id=?, rating=? WHERE id=?\";\n    try {\n        const [result] = await db.query(sql, [\n            name,\n            description,\n            price,\n            image_url,\n            stock_quantity,\n            category,\n            supplier_id,\n            rating,\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Product not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Product updated successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating product:\", error);\n        res.status(500).json({\n            error: \"Error updating product\"\n        });\n    }\n}\nasync function handleDeleteProduct(req, res, id) {\n    const sql = \"UPDATE products SET deleted = TRUE WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Product not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Product marked as deleted successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error marking product as deleted:\", error);\n        res.status(500).json({\n            error: \"Error marking product as deleted\"\n        });\n    }\n}\nasync function handleGetSalesReport(req, res) {\n    try {\n        const [result] = await db.query(\"SELECT * FROM user_login\");\n        res.status(200).json(result);\n    } catch (error) {\n        console.error(\"Error fetching sales report:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching sales report data\"\n        });\n    }\n}\nasync function handleUpdateOrderStatus(req, res, id) {\n    const { status } = req.body;\n    console.log(\"Updating order status:\", id, status);\n    const sql = \"UPDATE orders SET status = ? WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            status,\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order status updated successfully\",\n                status: status\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating order status:\", error);\n        res.status(500).json({\n            error: \"Error updating order status\"\n        });\n    }\n}\nasync function handleCancelOrder(req, res, id) {\n    const sql = \"UPDATE orders SET status = 'Cancelled' WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order cancelled successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error cancelling order:\", error);\n        res.status(500).json({\n            error: \"Error cancelling order\"\n        });\n    }\n}\nasync function handleUpdateOrder(req, res, id) {\n    const { order_date } = req.body;\n    const sql = \"UPDATE orders SET order_date = ? WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            order_date,\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order date updated successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating order date:\", error);\n        res.status(500).json({\n            error: \"Error updating order date\"\n        });\n    }\n}\nasync function handleRemoveOrderFromSalesReport(req, res) {\n    const { id } = req.query;\n    const sql = \"UPDATE orders SET in_sales_report = 0 WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order removed from sales report successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error removing order from sales report:\", error);\n        res.status(500).json({\n            error: \"Error removing order from sales report\"\n        });\n    }\n}\nasync function handleGetOrders(req, res) {\n    try {\n        const [result] = await db.query(`\r\n      SELECT o.*, \r\n             GROUP_CONCAT(CONCAT(op.name, ' (', op.quantity, ')') SEPARATOR ', ') AS ordered_products\r\n      FROM orders o\r\n      LEFT JOIN ordered_products op ON o.id = op.order_id\r\n      WHERE o.in_sales_report = 1\r\n      GROUP BY o.id\r\n    `);\n        res.status(200).json(result);\n    } catch (error) {\n        console.error(\"Error fetching orders:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching orders\"\n        });\n    }\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL1suLi5uZXh0YXBpXS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBbUM7QUFDUDtBQUNnQjtBQUNMO0FBRXZDLE1BQU1LLEtBQUtMLGdFQUFnQixDQUFDO0lBQzFCTyxNQUFNQyxRQUFRQyxHQUFHLENBQUNDLFVBQVU7SUFDNUJDLE1BQU1ILFFBQVFDLEdBQUcsQ0FBQ0csVUFBVTtJQUM1QkMsTUFBTUwsUUFBUUMsR0FBRyxDQUFDSyxVQUFVO0lBQzVCQyxVQUFVUCxRQUFRQyxHQUFHLENBQUNPLGNBQWM7SUFDcENDLFVBQVVULFFBQVFDLEdBQUcsQ0FBQ1MsY0FBYztJQUNwQ0Msb0JBQW9CO0lBQ3BCQyxpQkFBaUI7SUFDakJDLFlBQVk7QUFDZDtBQUVlLGVBQWVDLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1QyxNQUFNLEVBQUVDLE1BQU0sRUFBRSxHQUFHRjtJQUNuQixNQUFNLEVBQUVHLFFBQVEsRUFBRXRCLEtBQUssRUFBRSxHQUFHSCwwQ0FBS0EsQ0FBQ3NCLElBQUlJLEdBQUcsRUFBRTtJQUUzQ0MsUUFBUUMsR0FBRyxDQUFDLHFCQUFxQkosUUFBUUMsVUFBVXRCO0lBRW5ELElBQUlzQixhQUFhLGFBQWE7UUFDNUJGLElBQUlNLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUFxQjtRQUNyRDtJQUNGO0lBRUEsSUFBSU4sYUFBYSxtQkFBbUI7UUFDbEMsSUFBSTtZQUNGLE1BQU0sQ0FBQ08sUUFBUSxHQUFHLE1BQU01QixHQUFHRCxLQUFLLENBQUM7WUFDakMsSUFBSTZCLFFBQVFDLE1BQU0sR0FBRyxHQUFHO2dCQUN0QlYsSUFBSU0sTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFBRUksVUFBVUYsT0FBTyxDQUFDLEVBQUUsQ0FBQ0csU0FBUztnQkFBQztZQUN4RCxPQUFPO2dCQUNMWixJQUFJTSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUFFTSxPQUFPO2dCQUFr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ZWJwYWNrOi8vYWRtaW5wYW5lbC8uL3NyYy9wYWdlcy9hcGkvWy4uLm5leHRhcGldLmpzPzI4NzkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG15c3FsIGZyb20gJ215c3FsMi9wcm9taXNlJztcclxuaW1wb3J0IHsgcGFyc2UgfSBmcm9tICd1cmwnO1xyXG5pbXBvcnQgeyBzaWduLCB2ZXJpZnkgfSBmcm9tICdqc29ud2VidG9rZW4nO1xyXG5pbXBvcnQgeyBxdWVyeSB9IGZyb20gJy4uLy4uL3V0aWxzL2RiJztcclxuXHJcbmNvbnN0IGRiID0gbXlzcWwuY3JlYXRlUG9vbCh7XHJcbiAgaG9zdDogcHJvY2Vzcy5lbnYuTVlTUUxfSE9TVCxcclxuICBwb3J0OiBwcm9jZXNzLmVudi5NWVNRTF9QT1JULFxyXG4gIHVzZXI6IHByb2Nlc3MuZW52Lk1ZU1FMX1VTRVIsXHJcbiAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52Lk1ZU1FMX1BBU1NXT1JELFxyXG4gIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5NWVNRTF9EQVRBQkFTRSxcclxuICB3YWl0Rm9yQ29ubmVjdGlvbnM6IHRydWUsXHJcbiAgY29ubmVjdGlvbkxpbWl0OiAxMCxcclxuICBxdWV1ZUxpbWl0OiAwXHJcbn0pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgbWV0aG9kIH0gPSByZXE7XHJcbiAgY29uc3QgeyBwYXRobmFtZSwgcXVlcnkgfSA9IHBhcnNlKHJlcS51cmwsIHRydWUpO1xyXG5cclxuICBjb25zb2xlLmxvZygnUmVjZWl2ZWQgcmVxdWVzdDonLCBtZXRob2QsIHBhdGhuYW1lLCBxdWVyeSk7XHJcblxyXG4gIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvdGVzdCcpIHtcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ1Rlc3Qgcm91dGUgd29ya2luZycgfSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2FkbWluLW5hbWUnKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUIGZ1bGxfbmFtZSBGUk9NIGFkbWluIExJTUlUIDEnKTtcclxuICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgZnVsbE5hbWU6IHJlc3VsdHNbMF0uZnVsbF9uYW1lIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdBZG1pbiBub3QgZm91bmQnIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBhZG1pbiBuYW1lOicsIGVycm9yKTtcclxuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIGFkbWluIG5hbWUnIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIHN3aXRjaCAobWV0aG9kKSB7XHJcbiAgICAgIGNhc2UgJ0dFVCc6XHJcbiAgICBcclxuICAgICAgICBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2NoZWNrLWF1dGgnKSB7XHJcbiAgICAgICAgICBjb25zdCBhdXRoSGVhZGVyID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbjtcclxuICAgICAgICAgIGlmICghYXV0aEhlYWRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLCB1c2VybmFtZVBhc3N3b3JkVmVyaWZpZWQ6IGZhbHNlIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgY29uc3QgdG9rZW4gPSBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgICAgICAgICAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoZGVjb2RlZC5leHAgJiYgZGVjb2RlZC5leHAgPiBub3cpIHtcclxuICAgICAgICAgICAgICAvLyBUb2tlbiBpcyBzdGlsbCB2YWxpZFxyXG4gICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IFxyXG4gICAgICAgICAgICAgICAgaXNBdXRoZW50aWNhdGVkOiB0cnVlLCBcclxuICAgICAgICAgICAgICAgIHVzZXJuYW1lUGFzc3dvcmRWZXJpZmllZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGV4cGlyZXNJbjogZGVjb2RlZC5leHAgLSBub3dcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAvLyBUb2tlbiBoYXMgZXhwaXJlZFxyXG4gICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGlzQXV0aGVudGljYXRlZDogZmFsc2UsIHVzZXJuYW1lUGFzc3dvcmRWZXJpZmllZDogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGlzQXV0aGVudGljYXRlZDogZmFsc2UsIHVzZXJuYW1lUGFzc3dvcmRWZXJpZmllZDogZmFsc2UgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvcHJvZHVjdHMnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRQcm9kdWN0cyhyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvdG90YWwtc3RvY2snKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRUb3RhbFN0b2NrKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zYWxlcy1yZXBvcnQnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRTYWxlc1JlcG9ydChyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvc2FsZXMtZGF0YScpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFNhbGVzRGF0YShyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvdG90YWwtcHJvZHVjdHMnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRUb3RhbFByb2R1Y3RzKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS90b3AtcHJvZHVjdHMnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRUb3BQcm9kdWN0cyhyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvcmF0ZWQtcHJvZHVjdHMtY291bnQnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRSYXRlZFByb2R1Y3RzQ291bnQocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2xvZ291dCcpIHtcclxuICAgICAgICAgIGhhbmRsZUxvZ291dChyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvb3JkZXJzJykge1xyXG4gICAgICAgICAgYXdhaXQgaGFuZGxlR2V0T3JkZXJzKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvYWRtaW4tZGF0YScpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldEFkbWluRGF0YShyZXEsIHJlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAnUE9TVCc6XHJcbiAgICAgICAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zaWduaW4nKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVTaWduSW4ocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3ZhbGlkYXRlLXBpbicpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZVZhbGlkYXRlUGluKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9wcm9kdWN0cycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUFkZFByb2R1Y3QocmVxLCByZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgY2FzZSAnUFVUJzpcclxuICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9wcm9kdWN0cy8nKSkge1xyXG4gICAgY29uc3QgaWQgPSBwYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpO1xyXG4gICAgYXdhaXQgaGFuZGxlVXBkYXRlUHJvZHVjdChyZXEsIHJlcywgaWQpO1xyXG4gIH0gZWxzZSBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9vcmRlcnMvJykpIHtcclxuICAgIGNvbnN0IHBhcnRzID0gcGF0aG5hbWUuc3BsaXQoJy8nKTtcclxuICAgIGNvbnN0IGlkID0gcGFydHNbM107IC8vIFRoaXMgaXMgdGhlIG9yZGVyIElEXHJcbiAgICBpZiAocGFydHNbNF0gPT09ICdzdGF0dXMnKSB7XHJcbiAgICAgIGF3YWl0IGhhbmRsZVVwZGF0ZU9yZGVyU3RhdHVzKHJlcSwgcmVzLCBpZCk7XHJcbiAgICB9IGVsc2UgaWYgKHBhcnRzWzRdID09PSAnY2FuY2VsJykge1xyXG4gICAgICBhd2FpdCBoYW5kbGVDYW5jZWxPcmRlcihyZXEsIHJlcywgaWQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYXdhaXQgaGFuZGxlVXBkYXRlT3JkZXIocmVxLCByZXMsIGlkKTtcclxuICAgIH1cclxuICB9XHJcbiAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS91cGRhdGUtYWRtaW4nKSB7XHJcbiAgICBhd2FpdCBoYW5kbGVVcGRhdGVBZG1pbkRhdGEocmVxLCByZXMpO1xyXG4gIH1cclxuICBicmVhaztcclxuICBjYXNlICdERUxFVEUnOlxyXG4gICAgICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL3Byb2R1Y3RzLycpKSB7XHJcbiAgICAgICAgICBjb25zdCBpZCA9IHBhdGhuYW1lLnNwbGl0KCcvJykucG9wKCk7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVEZWxldGVQcm9kdWN0KHJlcSwgcmVzLCBpZCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL29yZGVycy8nKSAmJiBwYXRobmFtZS5lbmRzV2l0aCgnL3NhbGVzcmVwb3J0JykpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZVJlbW92ZU9yZGVyRnJvbVNhbGVzUmVwb3J0KHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1JvdXRlIG5vdCBmb3VuZCcgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsIFsnR0VUJywgJ1BPU1QnLCAnUFVUJywgJ0RFTEVURSddKTtcclxuICAgICAgICByZXMuc3RhdHVzKDQwNSkuZW5kKGBNZXRob2QgJHttZXRob2R9IE5vdCBBbGxvd2VkYCk7XHJcbiAgICB9XHJcblxyXG4gIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdSb3V0ZSBub3QgZm91bmQnIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBBUEkgcm91dGU6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0JyB9KTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlU2lnbkluKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyB1c2VybmFtZSwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xyXG4gIGNvbnNvbGUubG9nKCdTaWduaW4gYXR0ZW1wdDonLCB7IHVzZXJuYW1lIH0pOyAvLyBEb24ndCBsb2cgcGFzc3dvcmRzXHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUICogRlJPTSBhZG1pbiBXSEVSRSB1c2VybmFtZSA9ID8nLCBbdXNlcm5hbWVdKTtcclxuICAgIGNvbnNvbGUubG9nKCdEYXRhYmFzZSBxdWVyeSByZXN1bHRzOicsIHJlc3VsdHMpO1xyXG5cclxuICAgIGlmIChyZXN1bHRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnVXNlciBub3QgZm91bmQnKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIHVzZXJuYW1lIG9yIHBhc3N3b3JkJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB1c2VyID0gcmVzdWx0c1swXTtcclxuICAgIFxyXG4gICAgLy8gRm9yIG5vdywgZGlyZWN0bHkgY29tcGFyZSBwYXNzd29yZHNcclxuICAgIGNvbnN0IHBhc3N3b3JkTWF0Y2ggPSBwYXNzd29yZCA9PT0gdXNlci5wYXNzd29yZDtcclxuXHJcbiAgICBpZiAoIXBhc3N3b3JkTWF0Y2gpIHtcclxuICAgICAgY29uc29sZS5sb2coJ1Bhc3N3b3JkIG1pc21hdGNoJyk7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnSW52YWxpZCB1c2VybmFtZSBvciBwYXNzd29yZCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdG9rZW4gPSBzaWduKHsgdXNlcklkOiB1c2VyLmlkIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIHsgZXhwaXJlc0luOiAnNmgnIH0pO1xyXG4gICAgY29uc29sZS5sb2coJ0xvZ2luIHN1Y2Nlc3NmdWwsIHRva2VuIGdlbmVyYXRlZCcpO1xyXG4gICAgXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdTaWduaW4gc3VjY2Vzc2Z1bCcsIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lLCB0b2tlbjogdG9rZW4gfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1NpZ24gaW4gZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIGR1cmluZyBzaWduaW4nIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlVmFsaWRhdGVQaW4ocmVxLCByZXMpIHtcclxuICBjb25zdCB7IHBpbiB9ID0gcmVxLmJvZHk7XHJcbiAgY29uc3QgdG9rZW4gPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uPy5zcGxpdCgnICcpWzFdO1xyXG5cclxuICBpZiAoIXRva2VuKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ05vIHRva2VuIHByb3ZpZGVkJyB9KTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IGRiLnF1ZXJ5KCdTRUxFQ1QgcGluIEZST00gYWRtaW4gV0hFUkUgaWQgPSA/JywgW2RlY29kZWQudXNlcklkXSk7XHJcbiAgICBcclxuICAgIGlmIChyZXN1bHRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ0FkbWluIG5vdCBmb3VuZCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc3RvcmVkUGluID0gcmVzdWx0c1swXS5waW47XHJcbiAgICBcclxuICAgIGlmIChTdHJpbmcocGluKSA9PT0gU3RyaW5nKHN0b3JlZFBpbikpIHtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnUElOIHZhbGlkYXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgUElOJyB9KTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdmFsaWRhdGluZyBQSU46JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIHZhbGlkYXRpbmcgUElOJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUxvZ291dChyZXEsIHJlcykge1xyXG4gIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbj8uc3BsaXQoJyAnKVsxXTtcclxuICBpZiAodG9rZW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEludmFsaWRhdGUgdGhlIHRva2VuIGluIHRoZSBkYXRhYmFzZSBvciB3aGVyZXZlciB5b3UncmUgc3RvcmluZyBhY3RpdmUgc2Vzc2lvbnNcclxuICAgICAgYXdhaXQgZGIucXVlcnkoJ1VQREFURSBzZXNzaW9ucyBTRVQgaXNfYWN0aXZlID0gRkFMU0UgV0hFUkUgdG9rZW4gPSA/JywgW3Rva2VuXSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbnZhbGlkYXRpbmcgdG9rZW46JywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuICByZXMuc2V0SGVhZGVyKCdTZXQtQ29va2llJywgJ3Rva2VuPTsgUGF0aD0vOyBFeHBpcmVzPVRodSwgMDEgSmFuIDE5NzAgMDA6MDA6MDAgR01UOyBIdHRwT25seScpO1xyXG4gIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ0xvZ291dCBzdWNjZXNzZnVsJyB9KTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0QWRtaW5EYXRhKHJlcSwgcmVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IGRiLnF1ZXJ5KCdTRUxFQ1QgZnVsbF9uYW1lLCB1c2VybmFtZSwgcGFzc3dvcmQsIHBpbiwgcm9sZSBGUk9NIGFkbWluIExJTUlUIDEnKTtcclxuICAgIGlmIChyZXN1bHRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3QgYWRtaW5EYXRhID0gcmVzdWx0c1swXTtcclxuICAgICAgLy8gTWFzayB0aGUgcGFzc3dvcmQgYW5kIFBJTlxyXG4gICAgICBhZG1pbkRhdGEucGFzc3dvcmQgPSAnKicucmVwZWF0KGFkbWluRGF0YS5wYXNzd29yZC5sZW5ndGgpO1xyXG4gICAgICBhZG1pbkRhdGEucGluID0gJyonLnJlcGVhdChhZG1pbkRhdGEucGluLmxlbmd0aCk7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGFkbWluRGF0YSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnQWRtaW4gbm90IGZvdW5kJyB9KTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWRtaW4gZGF0YTonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgYWRtaW4gZGF0YScgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBVcGRhdGUgdGhpcyBmdW5jdGlvbiB0byBoYXNoIHRoZSBQSU4gYmVmb3JlIHN0b3JpbmdcclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlVXBkYXRlQWRtaW5EYXRhKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyBmdWxsX25hbWUsIHVzZXJuYW1lLCBwYXNzd29yZCwgcGluLCByb2xlIH0gPSByZXEuYm9keTtcclxuICBcclxuICB0cnkge1xyXG4gICAgbGV0IHNxbCA9ICdVUERBVEUgYWRtaW4gU0VUIGZ1bGxfbmFtZSA9ID8sIHVzZXJuYW1lID0gPywgcm9sZSA9ID8nO1xyXG4gICAgbGV0IHBhcmFtcyA9IFtmdWxsX25hbWUsIHVzZXJuYW1lLCByb2xlXTtcclxuXHJcbiAgICBpZiAocGFzc3dvcmQpIHtcclxuICAgICAgc3FsICs9ICcsIHBhc3N3b3JkID0gPyc7XHJcbiAgICAgIHBhcmFtcy5wdXNoKHBhc3N3b3JkKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocGluKSB7XHJcbiAgICAgIHNxbCArPSAnLCBwaW4gPSA/JztcclxuICAgICAgcGFyYW1zLnB1c2gocGluKTtcclxuICAgIH1cclxuXHJcbiAgICBzcWwgKz0gJyBXSEVSRSBpZCA9IDEnOyAvLyBBc3N1bWluZyB0aGVyZSdzIG9ubHkgb25lIGFkbWluIHJlY29yZFxyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KHNxbCwgcGFyYW1zKTtcclxuXHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnQWRtaW4gbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ0FkbWluIGRhdGEgdXBkYXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBhZG1pbiBkYXRhOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB1cGRhdGluZyBhZG1pbiBkYXRhJyB9KTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0U2FsZXNEYXRhKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyB0aW1lRnJhbWUgfSA9IHJlcS5xdWVyeTtcclxuICBsZXQgZGF0ZUNvbmRpdGlvbiwgc3RhdHVzQ29uZGl0aW9uO1xyXG4gIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcclxuICB0b2RheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcclxuXHJcbiAgc3dpdGNoICh0aW1lRnJhbWUpIHtcclxuICAgIGNhc2UgJ3RvZGF5JzpcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9ICdEQVRFKG9yZGVyX2RhdGUpID0gQ1VSREFURSgpJztcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICd5ZXN0ZXJkYXknOlxyXG4gICAgICBkYXRlQ29uZGl0aW9uID0gJ0RBVEUob3JkZXJfZGF0ZSkgPSBEQVRFX1NVQihDVVJEQVRFKCksIElOVEVSVkFMIDEgREFZKSc7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAnbGFzdFdlZWsnOlxyXG4gICAgICBjb25zdCBsYXN0V2Vla1N0YXJ0ID0gbmV3IERhdGUodG9kYXkpO1xyXG4gICAgICBsYXN0V2Vla1N0YXJ0LnNldERhdGUobGFzdFdlZWtTdGFydC5nZXREYXRlKCkgLSA3KTtcclxuICAgICAgY29uc3QgbGFzdFdlZWtFbmQgPSBuZXcgRGF0ZSh0b2RheSk7XHJcbiAgICAgIGxhc3RXZWVrRW5kLnNldERhdGUobGFzdFdlZWtFbmQuZ2V0RGF0ZSgpIC0gMSk7XHJcbiAgICAgIGRhdGVDb25kaXRpb24gPSBgREFURShvcmRlcl9kYXRlKSBCRVRXRUVOICcke2xhc3RXZWVrU3RhcnQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfScgQU5EICcke2xhc3RXZWVrRW5kLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXX0nYDtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICdsYXN0TW9udGgnOlxyXG4gICAgICBjb25zdCBsYXN0TW9udGhTdGFydCA9IG5ldyBEYXRlKHRvZGF5KTtcclxuICAgICAgbGFzdE1vbnRoU3RhcnQuc2V0TW9udGgobGFzdE1vbnRoU3RhcnQuZ2V0TW9udGgoKSAtIDEpO1xyXG4gICAgICBjb25zdCBsYXN0TW9udGhFbmQgPSBuZXcgRGF0ZSh0b2RheSk7XHJcbiAgICAgIGxhc3RNb250aEVuZC5zZXREYXRlKGxhc3RNb250aEVuZC5nZXREYXRlKCkgLSAxKTtcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9IGBEQVRFKG9yZGVyX2RhdGUpIEJFVFdFRU4gJyR7bGFzdE1vbnRoU3RhcnQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfScgQU5EICcke2xhc3RNb250aEVuZC50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF19J2A7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9ICdEQVRFKG9yZGVyX2RhdGUpID0gQ1VSREFURSgpJztcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyBUb3RhbCBTYWxlcyAoYWx3YXlzIG9ubHkgXCJEZWxpdmVyZWRcIiBzdGF0dXMpXHJcbiAgICBjb25zdCBbc2FsZXNSZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICBTRUxFQ1QgQ09BTEVTQ0UoU1VNKHRvdGFsKSwgMCkgYXMgcGVyaW9kU2FsZXNcclxuICAgICAgRlJPTSBvcmRlcnNcclxuICAgICAgV0hFUkUgJHtkYXRlQ29uZGl0aW9ufSBBTkQgc3RhdHVzID0gJ0RlbGl2ZXJlZCdcclxuICAgIGApO1xyXG5cclxuICAgIC8vIFRvdGFsIE9yZGVyc1xyXG4gICAgbGV0IG9yZGVyc1N0YXR1c0NvbmRpdGlvbiA9IFwic3RhdHVzID0gJ0RlbGl2ZXJlZCdcIjtcclxuICAgIGlmICh0aW1lRnJhbWUgPT09ICdsYXN0V2VlaycgfHwgdGltZUZyYW1lID09PSAnbGFzdE1vbnRoJykge1xyXG4gICAgICBvcmRlcnNTdGF0dXNDb25kaXRpb24gPSBcInN0YXR1cyBJTiAoJ09yZGVyIFBsYWNlZCcsICdQcm9jZXNzZWQnLCAnU2hpcHBlZCcsICdEZWxpdmVyZWQnLCAnQ2FuY2VsbGVkJylcIjtcclxuICAgIH1cclxuICAgIGNvbnN0IFtvcmRlcnNSZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICBTRUxFQ1QgQ09VTlQoKikgYXMgdG90YWxPcmRlcnNcclxuICAgICAgRlJPTSBvcmRlcnNcclxuICAgICAgV0hFUkUgJHtkYXRlQ29uZGl0aW9ufSBBTkQgJHtvcmRlcnNTdGF0dXNDb25kaXRpb259XHJcbiAgICBgKTtcclxuXHJcbiAgICAvLyBUb3RhbCBDdXN0b21lcnMgKGFsd2F5cyBhbGwgc3RhdHVzZXMpXHJcbiAgICBjb25zdCBbY3VzdG9tZXJzUmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KGBcclxuICAgICAgU0VMRUNUIENPVU5UKERJU1RJTkNUIHVzZXJfaWQpIGFzIHRvdGFsQ3VzdG9tZXJzXHJcbiAgICAgIEZST00gb3JkZXJzXHJcbiAgICAgIFdIRVJFICR7ZGF0ZUNvbmRpdGlvbn1cclxuICAgIGApO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IHtcclxuICAgICAgcGVyaW9kU2FsZXM6IE51bWJlcihzYWxlc1Jlc3VsdFswXS5wZXJpb2RTYWxlcyksXHJcbiAgICAgIHRvdGFsT3JkZXJzOiBvcmRlcnNSZXN1bHRbMF0udG90YWxPcmRlcnMsXHJcbiAgICAgIHRvdGFsQ3VzdG9tZXJzOiBjdXN0b21lcnNSZXN1bHRbMF0udG90YWxDdXN0b21lcnNcclxuICAgIH07XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ocmVzdWx0KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgc2FsZXMgZGF0YTonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgZmV0Y2hpbmcgc2FsZXMgZGF0YScgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRUb3RhbFByb2R1Y3RzKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUIENPVU5UKCopIGFzIHRvdGFsUHJvZHVjdHMgRlJPTSBwcm9kdWN0cycpO1xyXG4gIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdFswXSk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFRvcFByb2R1Y3RzKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeShgXHJcbiAgICBTRUxFQ1QgXHJcbiAgICAgIHAuaWQsXHJcbiAgICAgIHAubmFtZSxcclxuICAgICAgcC5pbWFnZV91cmwsXHJcbiAgICAgIHAucmF0aW5nLFxyXG4gICAgICBDT0FMRVNDRShTVU0ob3AucXVhbnRpdHkpLCAwKSBhcyBzb2xkXHJcbiAgICBGUk9NIHByb2R1Y3RzIHBcclxuICAgIExFRlQgSk9JTiBvcmRlcmVkX3Byb2R1Y3RzIG9wIE9OIHAuaWQgPSBvcC5wcm9kdWN0X2lkXHJcbiAgICBHUk9VUCBCWSBwLmlkXHJcbiAgICBPUkRFUiBCWSBzb2xkIERFU0MsIHAucmF0aW5nIERFU0NcclxuICAgIExJTUlUIDVcclxuICBgKTtcclxuICByZXMuc3RhdHVzKDIwMCkuanNvbihyZXN1bHQpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRSYXRlZFByb2R1Y3RzQ291bnQocmVxLCByZXMpIHtcclxuICBjb25zdCB7IHRpbWVGcmFtZSB9ID0gcmVxLnF1ZXJ5O1xyXG4gIGxldCBkYXRlQ29uZGl0aW9uO1xyXG5cclxuICBzd2l0Y2ggKHRpbWVGcmFtZSkge1xyXG4gICAgY2FzZSAndG9kYXknOlxyXG4gICAgICBkYXRlQ29uZGl0aW9uID0gJ0RBVEUoY3JlYXRlZF9hdCkgPSBDVVJEQVRFKCknO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgJ3llc3RlcmRheSc6XHJcbiAgICAgIGRhdGVDb25kaXRpb24gPSAnREFURShjcmVhdGVkX2F0KSA9IERBVEVfU1VCKENVUkRBVEUoKSwgSU5URVJWQUwgMSBEQVkpJztcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICdsYXN0V2Vlayc6XHJcbiAgICAgIGRhdGVDb25kaXRpb24gPSAnREFURShjcmVhdGVkX2F0KSBCRVRXRUVOIERBVEVfU1VCKENVUkRBVEUoKSwgSU5URVJWQUwgMSBXRUVLKSBBTkQgQ1VSREFURSgpJztcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICdsYXN0TW9udGgnOlxyXG4gICAgICBkYXRlQ29uZGl0aW9uID0gJ0RBVEUoY3JlYXRlZF9hdCkgQkVUV0VFTiBEQVRFX1NVQihDVVJEQVRFKCksIElOVEVSVkFMIDEgTU9OVEgpIEFORCBDVVJEQVRFKCknO1xyXG4gICAgICBicmVhaztcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgIGRhdGVDb25kaXRpb24gPSAnREFURShjcmVhdGVkX2F0KSA9IENVUkRBVEUoKSc7XHJcbiAgfVxyXG5cclxuICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KGBcclxuICAgIFNFTEVDVCBDT1VOVChESVNUSU5DVCBwcm9kdWN0X2lkKSBhcyByYXRlZFByb2R1Y3RzQ291bnRcclxuICAgIEZST00gcHJvZHVjdF9yYXRpbmdzXHJcbiAgICBXSEVSRSAke2RhdGVDb25kaXRpb259XHJcbiAgYCk7XHJcblxyXG4gIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdFswXSk7XHJcbn1cclxuXHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRQcm9kdWN0cyhyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgcGFnZSA9IDEsIGxpbWl0ID0gMTAgfSA9IHJlcS5xdWVyeTtcclxuICBjb25zdCBvZmZzZXQgPSAocGFnZSAtIDEpICogbGltaXQ7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbY291bnRSZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoJ1NFTEVDVCBDT1VOVCgqKSBhcyB0b3RhbCBGUk9NIHByb2R1Y3RzIFdIRVJFIGRlbGV0ZWQgPSBGQUxTRScpO1xyXG4gICAgY29uc3QgdG90YWxJdGVtcyA9IGNvdW50UmVzdWx0WzBdLnRvdGFsO1xyXG4gICAgY29uc3QgdG90YWxQYWdlcyA9IE1hdGguY2VpbCh0b3RhbEl0ZW1zIC8gbGltaXQpO1xyXG5cclxuICAgIGNvbnN0IFtwcm9kdWN0c10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUICogRlJPTSBwcm9kdWN0cyBXSEVSRSBkZWxldGVkID0gRkFMU0UgTElNSVQgPyBPRkZTRVQgPycsIFtwYXJzZUludChsaW1pdCksIG9mZnNldF0pO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgcHJvZHVjdHMsXHJcbiAgICAgIGN1cnJlbnRQYWdlOiBwYXJzZUludChwYWdlKSxcclxuICAgICAgdG90YWxQYWdlcyxcclxuICAgICAgdG90YWxJdGVtc1xyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBmZXRjaGluZyBwcm9kdWN0cycgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRUb3RhbFN0b2NrKHJlcSwgcmVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoJ1NFTEVDVCBTVU0oc3RvY2tfcXVhbnRpdHkpIGFzIHRvdGFsU3RvY2sgRlJPTSBwcm9kdWN0cycpO1xyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyB0b3RhbFN0b2NrOiByZXN1bHRbMF0udG90YWxTdG9jayB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgdG90YWwgc3RvY2s6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIGZldGNoaW5nIHRvdGFsIHN0b2NrJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUFkZFByb2R1Y3QocmVxLCByZXMpIHtcclxuICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uLCBwcmljZSwgaW1hZ2VfdXJsLCBzdG9ja19xdWFudGl0eSwgY2F0ZWdvcnksIHN1cHBsaWVyX2lkLCByYXRpbmcgfSA9IHJlcS5ib2R5O1xyXG4gIGNvbnN0IG9yZGVyX2lkID0gZ2VuZXJhdGVPcmRlcklkKCk7XHJcbiAgY29uc3Qgc3FsID0gXCJJTlNFUlQgSU5UTyBwcm9kdWN0cyAobmFtZSwgZGVzY3JpcHRpb24sIHByaWNlLCBpbWFnZV91cmwsIHN0b2NrX3F1YW50aXR5LCBjYXRlZ29yeSwgc3VwcGxpZXJfaWQsIG9yZGVyX2lkLCByYXRpbmcpIFZBTFVFUyAoPywgPywgPywgPywgPywgPywgPywgPywgPylcIjtcclxuICBcclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeShzcWwsIFtuYW1lLCBkZXNjcmlwdGlvbiwgcHJpY2UsIGltYWdlX3VybCwgc3RvY2tfcXVhbnRpdHksIGNhdGVnb3J5LCBzdXBwbGllcl9pZCwgb3JkZXJfaWQsIHJhdGluZ10pO1xyXG4gICAgcmVzLnN0YXR1cygyMDEpLmpzb24oeyBtZXNzYWdlOiAnUHJvZHVjdCBhZGRlZCBzdWNjZXNzZnVsbHknLCBpZDogcmVzdWx0Lmluc2VydElkLCBvcmRlcl9pZDogb3JkZXJfaWQgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFkZGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBhZGRpbmcgcHJvZHVjdCcgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZW5lcmF0ZU9yZGVySWQoKSB7XHJcbiAgcmV0dXJuICdPUkQtJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KS50b1VwcGVyQ2FzZSgpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVVcGRhdGVQcm9kdWN0KHJlcSwgcmVzLCBpZCkge1xyXG4gIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIHByaWNlLCBpbWFnZV91cmwsIHN0b2NrX3F1YW50aXR5LCBjYXRlZ29yeSwgc3VwcGxpZXJfaWQsIHJhdGluZyB9ID0gcmVxLmJvZHk7XHJcbiAgY29uc3Qgc3FsID0gXCJVUERBVEUgcHJvZHVjdHMgU0VUIG5hbWU9PywgZGVzY3JpcHRpb249PywgcHJpY2U9PywgaW1hZ2VfdXJsPT8sIHN0b2NrX3F1YW50aXR5PT8sIGNhdGVnb3J5PT8sIHN1cHBsaWVyX2lkPT8sIHJhdGluZz0/IFdIRVJFIGlkPT9cIjtcclxuICBcclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeShzcWwsIFtuYW1lLCBkZXNjcmlwdGlvbiwgcHJpY2UsIGltYWdlX3VybCwgc3RvY2tfcXVhbnRpdHksIGNhdGVnb3J5LCBzdXBwbGllcl9pZCwgcmF0aW5nLCBpZF0pO1xyXG4gICAgaWYgKHJlc3VsdC5hZmZlY3RlZFJvd3MgPT09IDApIHtcclxuICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ1Byb2R1Y3QgdXBkYXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciB1cGRhdGluZyBwcm9kdWN0JyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZURlbGV0ZVByb2R1Y3QocmVxLCByZXMsIGlkKSB7XHJcbiAgY29uc3Qgc3FsID0gXCJVUERBVEUgcHJvZHVjdHMgU0VUIGRlbGV0ZWQgPSBUUlVFIFdIRVJFIGlkID0gP1wiO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW2lkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnUHJvZHVjdCBub3QgZm91bmQnIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnUHJvZHVjdCBtYXJrZWQgYXMgZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXJraW5nIHByb2R1Y3QgYXMgZGVsZXRlZDonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgbWFya2luZyBwcm9kdWN0IGFzIGRlbGV0ZWQnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRTYWxlc1JlcG9ydChyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KCdTRUxFQ1QgKiBGUk9NIHVzZXJfbG9naW4nKTtcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHNhbGVzIHJlcG9ydDonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgc2FsZXMgcmVwb3J0IGRhdGEnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlVXBkYXRlT3JkZXJTdGF0dXMocmVxLCByZXMsIGlkKSB7XHJcbiAgY29uc3QgeyBzdGF0dXMgfSA9IHJlcS5ib2R5O1xyXG4gIGNvbnNvbGUubG9nKCdVcGRhdGluZyBvcmRlciBzdGF0dXM6JywgaWQsIHN0YXR1cyk7XHJcblxyXG4gIGNvbnN0IHNxbCA9IFwiVVBEQVRFIG9yZGVycyBTRVQgc3RhdHVzID0gPyBXSEVSRSBpZCA9ID9cIjtcclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeShzcWwsIFtzdGF0dXMsIGlkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ09yZGVyIHN0YXR1cyB1cGRhdGVkIHN1Y2Nlc3NmdWxseScsIHN0YXR1czogc3RhdHVzIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBvcmRlciBzdGF0dXM6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIHVwZGF0aW5nIG9yZGVyIHN0YXR1cycgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVDYW5jZWxPcmRlcihyZXEsIHJlcywgaWQpIHtcclxuICBjb25zdCBzcWwgPSBcIlVQREFURSBvcmRlcnMgU0VUIHN0YXR1cyA9ICdDYW5jZWxsZWQnIFdIRVJFIGlkID0gP1wiO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW2lkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ09yZGVyIGNhbmNlbGxlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjYW5jZWxsaW5nIG9yZGVyOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBjYW5jZWxsaW5nIG9yZGVyJyB9KTtcclxuICB9XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlVXBkYXRlT3JkZXIocmVxLCByZXMsIGlkKSB7XHJcbiAgY29uc3QgeyBvcmRlcl9kYXRlIH0gPSByZXEuYm9keTtcclxuICBjb25zdCBzcWwgPSBcIlVQREFURSBvcmRlcnMgU0VUIG9yZGVyX2RhdGUgPSA/IFdIRVJFIGlkID0gP1wiO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW29yZGVyX2RhdGUsIGlkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ09yZGVyIGRhdGUgdXBkYXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBvcmRlciBkYXRlOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciB1cGRhdGluZyBvcmRlciBkYXRlJyB9KTtcclxuICB9XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlUmVtb3ZlT3JkZXJGcm9tU2FsZXNSZXBvcnQocmVxLCByZXMpIHtcclxuICBjb25zdCB7IGlkIH0gPSByZXEucXVlcnk7XHJcbiAgY29uc3Qgc3FsID0gXCJVUERBVEUgb3JkZXJzIFNFVCBpbl9zYWxlc19yZXBvcnQgPSAwIFdIRVJFIGlkID0gP1wiO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW2lkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ09yZGVyIHJlbW92ZWQgZnJvbSBzYWxlcyByZXBvcnQgc3VjY2Vzc2Z1bGx5JyB9KTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVtb3Zpbmcgb3JkZXIgZnJvbSBzYWxlcyByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIHJlbW92aW5nIG9yZGVyIGZyb20gc2FsZXMgcmVwb3J0JyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldE9yZGVycyhyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KGBcclxuICAgICAgU0VMRUNUIG8uKiwgXHJcbiAgICAgICAgICAgICBHUk9VUF9DT05DQVQoQ09OQ0FUKG9wLm5hbWUsICcgKCcsIG9wLnF1YW50aXR5LCAnKScpIFNFUEFSQVRPUiAnLCAnKSBBUyBvcmRlcmVkX3Byb2R1Y3RzXHJcbiAgICAgIEZST00gb3JkZXJzIG9cclxuICAgICAgTEVGVCBKT0lOIG9yZGVyZWRfcHJvZHVjdHMgb3AgT04gby5pZCA9IG9wLm9yZGVyX2lkXHJcbiAgICAgIFdIRVJFIG8uaW5fc2FsZXNfcmVwb3J0ID0gMVxyXG4gICAgICBHUk9VUCBCWSBvLmlkXHJcbiAgICBgKTtcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9yZGVyczonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgb3JkZXJzJyB9KTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgeyBoYW5kbGVVcGRhdGVBZG1pbkRhdGEgfTsiXSwibmFtZXMiOlsibXlzcWwiLCJwYXJzZSIsInNpZ24iLCJ2ZXJpZnkiLCJxdWVyeSIsImRiIiwiY3JlYXRlUG9vbCIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiTVlTUUxfSE9TVCIsInBvcnQiLCJNWVNRTF9QT1JUIiwidXNlciIsIk1ZU1FMX1VTRVIiLCJwYXNzd29yZCIsIk1ZU1FMX1BBU1NXT1JEIiwiZGF0YWJhc2UiLCJNWVNRTF9EQVRBQkFTRSIsIndhaXRGb3JDb25uZWN0aW9ucyIsImNvbm5lY3Rpb25MaW1pdCIsInF1ZXVlTGltaXQiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwicGF0aG5hbWUiLCJ1cmwiLCJjb25zb2xlIiwibG9nIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJyZXN1bHRzIiwibGVuZ3RoIiwiZnVsbE5hbWUiLCJmdWxsX25hbWUiLCJlcnJvciIsImF1dGhIZWFkZXIiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImlzQXV0aGVudGljYXRlZCIsInVzZXJuYW1lUGFzc3dvcmRWZXJpZmllZCIsInRva2VuIiwic3BsaXQiLCJkZWNvZGVkIiwiSldUX1NFQ1JFVCIsIm5vdyIsIk1hdGgiLCJmbG9vciIsIkRhdGUiLCJleHAiLCJleHBpcmVzSW4iLCJoYW5kbGVHZXRQcm9kdWN0cyIsImhhbmRsZUdldFRvdGFsU3RvY2siLCJoYW5kbGVHZXRTYWxlc1JlcG9ydCIsImhhbmRsZUdldFNhbGVzRGF0YSIsImhhbmRsZUdldFRvdGFsUHJvZHVjdHMiLCJoYW5kbGVHZXRUb3BQcm9kdWN0cyIsImhhbmRsZUdldFJhdGVkUHJvZHVjdHNDb3VudCIsImhhbmRsZUxvZ291dCIsImhhbmRsZUdldE9yZGVycyIsImhhbmRsZUdldEFkbWluRGF0YSIsImhhbmRsZVNpZ25JbiIsImhhbmRsZVZhbGlkYXRlUGluIiwiaGFuZGxlQWRkUHJvZHVjdCIsInN0YXJ0c1dpdGgiLCJpZCIsInBvcCIsImhhbmRsZVVwZGF0ZVByb2R1Y3QiLCJwYXJ0cyIsImhhbmRsZVVwZGF0ZU9yZGVyU3RhdHVzIiwiaGFuZGxlQ2FuY2VsT3JkZXIiLCJoYW5kbGVVcGRhdGVPcmRlciIsImhhbmRsZVVwZGF0ZUFkbWluRGF0YSIsImhhbmRsZURlbGV0ZVByb2R1Y3QiLCJlbmRzV2l0aCIsImhhbmRsZVJlbW92ZU9yZGVyRnJvbVNhbGVzUmVwb3J0Iiwic2V0SGVhZGVyIiwiZW5kIiwidXNlcm5hbWUiLCJib2R5IiwicGFzc3dvcmRNYXRjaCIsInVzZXJJZCIsInN1Y2Nlc3MiLCJwaW4iLCJzdG9yZWRQaW4iLCJTdHJpbmciLCJhZG1pbkRhdGEiLCJyZXBlYXQiLCJyb2xlIiwic3FsIiwicGFyYW1zIiwicHVzaCIsInJlc3VsdCIsImFmZmVjdGVkUm93cyIsInRpbWVGcmFtZSIsImRhdGVDb25kaXRpb24iLCJzdGF0dXNDb25kaXRpb24iLCJ0b2RheSIsInNldEhvdXJzIiwibGFzdFdlZWtTdGFydCIsInNldERhdGUiLCJnZXREYXRlIiwibGFzdFdlZWtFbmQiLCJ0b0lTT1N0cmluZyIsImxhc3RNb250aFN0YXJ0Iiwic2V0TW9udGgiLCJnZXRNb250aCIsImxhc3RNb250aEVuZCIsInNhbGVzUmVzdWx0Iiwib3JkZXJzU3RhdHVzQ29uZGl0aW9uIiwib3JkZXJzUmVzdWx0IiwiY3VzdG9tZXJzUmVzdWx0IiwicGVyaW9kU2FsZXMiLCJOdW1iZXIiLCJ0b3RhbE9yZGVycyIsInRvdGFsQ3VzdG9tZXJzIiwicGFnZSIsImxpbWl0Iiwib2Zmc2V0IiwiY291bnRSZXN1bHQiLCJ0b3RhbEl0ZW1zIiwidG90YWwiLCJ0b3RhbFBhZ2VzIiwiY2VpbCIsInByb2R1Y3RzIiwicGFyc2VJbnQiLCJjdXJyZW50UGFnZSIsInRvdGFsU3RvY2siLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJwcmljZSIsImltYWdlX3VybCIsInN0b2NrX3F1YW50aXR5IiwiY2F0ZWdvcnkiLCJzdXBwbGllcl9pZCIsInJhdGluZyIsIm9yZGVyX2lkIiwiZ2VuZXJhdGVPcmRlcklkIiwiaW5zZXJ0SWQiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsInRvVXBwZXJDYXNlIiwib3JkZXJfZGF0ZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/[...nextapi].js\n");

/***/ }),

/***/ "(api)/./src/utils/db.js":
/*!*************************!*\
  !*** ./src/utils/db.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n\nconst pool = mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createPool({\n    host: process.env.MYSQL_HOST,\n    port: parseInt(process.env.MYSQL_PORT),\n    database: process.env.MYSQL_DATABASE,\n    user: process.env.MYSQL_USER,\n    password: process.env.MYSQL_PASSWORD,\n    connectionLimit: 10,\n    waitForConnections: true,\n    queueLimit: 0\n});\nasync function query(sql, values) {\n    try {\n        const [results] = await pool.query(sql, values);\n        return results;\n    } catch (error) {\n        console.error(\"Database query error:\", error);\n        throw error;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (pool);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvdXRpbHMvZGIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFtQztBQUVuQyxNQUFNQyxPQUFPRCxnRUFBZ0IsQ0FBQztJQUM1QkcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDQyxVQUFVO0lBQzVCQyxNQUFNQyxTQUFTSixRQUFRQyxHQUFHLENBQUNJLFVBQVU7SUFDckNDLFVBQVVOLFFBQVFDLEdBQUcsQ0FBQ00sY0FBYztJQUNwQ0MsTUFBTVIsUUFBUUMsR0FBRyxDQUFDUSxVQUFVO0lBQzVCQyxVQUFVVixRQUFRQyxHQUFHLENBQUNVLGNBQWM7SUFDcENDLGlCQUFpQjtJQUNqQkMsb0JBQW9CO0lBQ3BCQyxZQUFZO0FBQ2Q7QUFFTyxlQUFlQyxNQUFNQyxHQUFHLEVBQUVDLE1BQU07SUFDckMsSUFBSTtRQUNGLE1BQU0sQ0FBQ0MsUUFBUSxHQUFHLE1BQU1yQixLQUFLa0IsS0FBSyxDQUFDQyxLQUFLQztRQUN4QyxPQUFPQztJQUNULEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMseUJBQXlCQTtRQUN2QyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSxpRUFBZXRCLElBQUlBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbnBhbmVsLy4vc3JjL3V0aWxzL2RiLmpzP2QzODQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG15c3FsIGZyb20gJ215c3FsMi9wcm9taXNlJztcclxuXHJcbmNvbnN0IHBvb2wgPSBteXNxbC5jcmVhdGVQb29sKHtcclxuICBob3N0OiBwcm9jZXNzLmVudi5NWVNRTF9IT1NULFxyXG4gIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52Lk1ZU1FMX1BPUlQpLFxyXG4gIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5NWVNRTF9EQVRBQkFTRSxcclxuICB1c2VyOiBwcm9jZXNzLmVudi5NWVNRTF9VU0VSLFxyXG4gIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5NWVNRTF9QQVNTV09SRCxcclxuICBjb25uZWN0aW9uTGltaXQ6IDEwLFxyXG4gIHdhaXRGb3JDb25uZWN0aW9uczogdHJ1ZSxcclxuICBxdWV1ZUxpbWl0OiAwXHJcbn0pO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5KHNxbCwgdmFsdWVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IHBvb2wucXVlcnkoc3FsLCB2YWx1ZXMpO1xyXG4gICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIHF1ZXJ5IGVycm9yOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgcG9vbDsiXSwibmFtZXMiOlsibXlzcWwiLCJwb29sIiwiY3JlYXRlUG9vbCIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiTVlTUUxfSE9TVCIsInBvcnQiLCJwYXJzZUludCIsIk1ZU1FMX1BPUlQiLCJkYXRhYmFzZSIsIk1ZU1FMX0RBVEFCQVNFIiwidXNlciIsIk1ZU1FMX1VTRVIiLCJwYXNzd29yZCIsIk1ZU1FMX1BBU1NXT1JEIiwiY29ubmVjdGlvbkxpbWl0Iiwid2FpdEZvckNvbm5lY3Rpb25zIiwicXVldWVMaW1pdCIsInF1ZXJ5Iiwic3FsIiwidmFsdWVzIiwicmVzdWx0cyIsImVycm9yIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/utils/db.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();